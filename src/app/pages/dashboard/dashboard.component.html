<!-- The overlay to block interaction -->
<div *ngIf="selectedConfig" class="fixed inset-0 bg-transparent z-40"></div>

<!-- Your Grid -->
<div *ngIf="vehicleConfigurations.length" [class.pointer-events-none]="selectedConfig">
  <div
    class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4 gap-6 p-4 bg-[#1C1C1C] text-white"
  >
    <div
      *ngFor="let config of vehicleConfigurations"
      (click)="onCardClick(config)"
      class="bg-[#2A2A2A] p-4 rounded-2xl flex flex-col h-full shadow-lg transition-all duration-300 transform cursor-pointer"
      [ngClass]="{
        'hover:shadow-yellow-500': isYellowCode(config.vehicleTypeAndCategory.code),
        'hover:shadow-blue-500': isBlueCode(config.vehicleTypeAndCategory.code),
      }"
    >
      <img
        [src]="config.imageAndName.signedUrl"
        alt="Vehicle Image"
        class="w-full h-48 object-cover rounded-md"
        loading="lazy"
      />
      <p class="mt-4 text-center font-bold text-[#FFD500] text-lg">
        {{ config.imageAndName.name }}
      </p>
    </div>
  </div>
</div>

<!-- The floating popup -->
<div
  *ngIf="selectedConfig"
  class="max-h-11/12 overflow-y-auto fixed top-1/2 left-1/2 z-50 transform -translate-x-1/2 -translate-y-1/2 bg-[#2A2A2A] text-white rounded-2xl shadow-2xl w-11/12 p-6 border border-yellow-500 custom-scroll"
>
  <button class="text-[#FF3B3F] float-end" (click)="closePopUp()">X</button>

  <img
    [src]="selectedConfig.imageAndName.signedUrl"
    alt="Vehicle Image"
    class="w-full h-80 object-cover rounded-md"
  />

  <p class="mt-4 text-center font-bold text-[#FFD500] text-xl">
    {{ selectedConfig.imageAndName.name }}
  </p>
  <p class="text-lg text-center text-gray-300 mb-4">
    {{ selectedConfig.vehicleTypeAndCategory.code }} -
    {{ selectedConfig.vehicleTypeAndCategory.label }}
  </p>

  <div class="flex flex-col lg:flex-row gap-4 mb-4">
    <app-view-global-settings
      [settings]="selectedConfig.globalSettings"
      class="flex-1 flex justify-center"
    ></app-view-global-settings>
    <app-view-specific-settings
      [settings]="selectedConfig.specificSettings"
      class="flex-1 flex justify-center"
    ></app-view-specific-settings>
  </div>

  <div class="flex flex-col gap-2">
    <button
      (click)="selectConfiguration(selectedConfig)"
      class="w-full bg-[#007BFF] hover:bg-[#005FCC] text-white font-semibold py-2 rounded transition"
    >
      Update Tuning
    </button>
    <button
      (click)="deleteConfiguration(selectedConfig)"
      class="w-full bg-[#FF3B3F] hover:bg-[#D32F2F] text-white font-semibold py-2 rounded transition"
    >
      Delete
    </button>
  </div>
</div>
