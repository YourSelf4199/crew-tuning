<div class="container">
  @if (isLoadingSettings || isSavingSettings) {
    <div class="fixed inset-0 flex flex-col items-center justify-center bg-black bg-opacity-50">
      <div class="flex justify-center items-center h-64">
        <div
          class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#fbbf24]"
        ></div>
      </div>
      <p class="mt-4 text-lg text-white">
        {{ isLoadingSettings ? 'Loading settings...' : 'Saving settings...' }}
      </p>
    </div>
  }

  @if (!isLoadingSettings) {
    <div class="flex justify-between items-center">
      <h1 class="text-xl font-bold text-yellow-400">Update Vehicle Tuning</h1>
      <div class="flex gap-2">
        <button
          (click)="toggleEditMode()"
          class="bg-yellow-400 text-gray-900 py-2 px-6 rounded-lg hover:bg-yellow-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"
        >
          {{ isEditing ? 'Cancel' : 'Edit' }}
        </button>
        <button
          *ngIf="isEditing"
          (click)="saveSettings()"
          class="bg-yellow-400 text-gray-900 py-2 px-6 rounded-lg hover:bg-yellow-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"
        >
          Save Changes
        </button>
      </div>
    </div>

    <div class="content">
      <div class="settings-section">
        <app-global-settings
          [settings]="globalSettings"
          [isReadOnly]="!isEditing"
          (settingsChange)="onGlobalSettingsChanged($event)"
        ></app-global-settings>
      </div>

      <div class="settings-section">
        <app-specific-settings
          [settings]="specificSettings"
          [isReadOnly]="!isEditing"
          (settingsChange)="onSpecificSettingsChanged($event)"
        ></app-specific-settings>
      </div>
    </div>
  }
</div>
